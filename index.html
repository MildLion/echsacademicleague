<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NCAL Study App</title>
    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>NCAL Study App</h1>
        <p>Practice for North County Academic League</p>
    </header>

    <main>
        <!-- Practice Setup Screen -->
        <section id="setup-screen" class="screen active">
            <div class="setup-container">
                <div class="setup-header">
                    <h2>Practice Controls</h2>
                    <div class="setup-icon">‚öôÔ∏è</div>
                </div>
                
                <!-- Subject Selection -->
                <div class="control-group">
                    <label for="subjects">Subjects</label>
                    <div class="subject-selector">
                        <div class="subject-group">
                            <h3>HUMANITIES</h3>
                            <label><input type="checkbox" value="Humanities>Geography"> Geography</label>
                            <label><input type="checkbox" value="Humanities>U.S. History"> U.S. History</label>
                            <label><input type="checkbox" value="Humanities>World History"> World History</label>
                            <label><input type="checkbox" value="Humanities>Music"> Music</label>
                            <label><input type="checkbox" value="Humanities>Mythology"> Mythology</label>
                            <label><input type="checkbox" value="Humanities>Art History"> Art History</label>
                        </div>
                        <div class="subject-group">
                            <h3>SCIENCE</h3>
                            <label><input type="checkbox" value="Science>Earth and Space Science"> Earth and Space Science</label>
                            <label><input type="checkbox" value="Science>Biological Science"> Biological Science</label>
                            <label><input type="checkbox" value="Science>Chemistry"> Chemistry</label>
                            <label><input type="checkbox" value="Science>Physics"> Physics</label>
                        </div>
                        <div class="subject-group">
                            <h3>MATH</h3>
                            <label><input type="checkbox" value="Math>Calculus"> Calculus</label>
                            <label><input type="checkbox" value="Math>Algebra"> Algebra</label>
                            <label><input type="checkbox" value="Math>Geometry"> Geometry</label>
                            <label><input type="checkbox" value="Math>Trigonometry"> Trigonometry</label>
                        </div>
                        <div class="subject-group">
                            <h3>LANGUAGES</h3>
                            <label><input type="checkbox" value="Languages>English"> English</label>
                            <label><input type="checkbox" value="Languages>English Literature"> English Literature</label>
                            <label><input type="checkbox" value="Languages>American Literature"> American Literature</label>
                            <label><input type="checkbox" value="Languages>French"> French</label>
                            <label><input type="checkbox" value="Languages>Spanish"> Spanish</label>
                        </div>
                        <div class="subject-group">
                            <h3>CURRENT EVENTS</h3>
                            <label><input type="checkbox" value="Current Events"> Current Events</label>
                        </div>
                        <div class="subject-toggle">
                            <button type="button" id="select-all" class="btn-toggle">Select All</button>
                            <button type="button" id="clear-all" class="btn-toggle">Clear All</button>
                        </div>
                    </div>
                    <div class="pool-preview" id="pool-preview">Pool preview: ~0 questions</div>
                </div>

                <!-- Level Selection -->
                <div class="control-group">
                    <label>Level</label>
                    <div class="level-selector">
                        <label class="level-option"><input type="radio" name="level" value=""> All Levels</label>
                        <label class="level-option"><input type="radio" name="level" value="Freshman"> Freshman</label>
                        <label class="level-option"><input type="radio" name="level" value="Junior Varsity"> Junior Varsity</label>
                        <label class="level-option"><input type="radio" name="level" value="Varsity"> Varsity</label>
                    </div>
                    <div class="level-note">If none selected, include all.</div>
                </div>

                <!-- Timer Selection -->
                <div class="control-group">
                    <label for="timer">Time per question</label>
                    <div class="timer-control">
                        <div class="timer-icon">‚è±Ô∏è</div>
                        <input type="range" id="timer" min="3" max="60" value="10" step="1">
                        <span id="timer-value" class="timer-value">10s</span>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons">
                    <button type="button" id="start-practice" class="btn-primary">
                        <span class="btn-icon">‚ñ∂Ô∏è</span>
                        Start
                    </button>
                    <button type="button" id="reset-filters" class="btn-secondary">Reset</button>
                </div>

                <!-- Error Panel -->
                <div id="error-panel" class="error-panel hidden">
                    <h3>Parser Errors</h3>
                    <div id="error-list"></div>
                    <div class="error-actions">
                        <button type="button" id="copy-errors">Copy Details</button>
                        <button type="button" id="dismiss-errors">Dismiss</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Practice Screen -->
        <section id="practice-screen" class="screen">
            <div class="practice-container">
                <div class="practice-main">
                    <div class="practice-header">
                        <button type="button" id="back-to-setup" class="btn-secondary">‚Üê Back to Setup</button>
                        <div class="question-context">
                            <span id="question-category" class="context-tag"></span>
                            <span id="question-level" class="context-tag"></span>
                            <span id="question-author" class="context-tag"></span>
                        </div>
                        <div class="question-counter" id="question-counter">Q 1 / 10</div>
                    </div>

                    <!-- Question Card -->
                    <div class="question-card">
                        <h3 id="question-text" class="question-text"></h3>
                        
                        <div class="answer-section">
                            <input type="text" id="answer-input" placeholder="Type your answer..." autocomplete="off">
                            <button type="button" id="submit-answer" class="btn-primary">Submit</button>
                        </div>

                        <!-- Timer Display -->
                        <div class="timer-display">
                            <div class="timer-ring">
                                <svg viewBox="0 0 100 100">
                                    <circle cx="50" cy="50" r="45" fill="none" stroke="#e0e0e0" stroke-width="5"/>
                                    <circle id="timer-progress" cx="50" cy="50" r="45" fill="none" stroke="#007bff" stroke-width="5" stroke-dasharray="283" stroke-dashoffset="283" transform="rotate(-90 50 50)"/>
                                </svg>
                                <span id="timer-countdown" class="timer-countdown">10</span>
                            </div>
                            <div class="timer-info">
                                <div class="timer-seconds">10s</div>
                                <div class="timer-note">Visible countdown ‚Ä¢ Auto-timeout</div>
                            </div>
                            <button type="button" id="pause-timer" class="btn-secondary">
                                <span class="pause-icon">‚è∏Ô∏è</span>
                                Pause
                            </button>
                            <div class="pause-hint">Space to pause</div>
                        </div>

                        <!-- Result Display -->
                        <div id="result-display" class="result-display hidden">
                            <div id="result-status" class="result-status"></div>
                            <div id="canonical-answer" class="canonical-answer"></div>
                            <button type="button" id="next-question" class="btn-primary">Next Question</button>
                        </div>
                    </div>

                    <!-- Empty State -->
                    <div id="empty-state" class="empty-state hidden">
                        <p>No questions match your current filters.</p>
                        <button type="button" id="reset-filters-empty" class="btn-secondary">Reset Filters</button>
                    </div>
                </div>

                <!-- Practice Sidebar -->
                <div class="practice-sidebar">
                    <!-- Session Stats -->
                    <div class="sidebar-section">
                        <h3>Session Stats</h3>
                        <div class="stats-cards">
                            <div class="stat-card correct">
                                <div class="stat-label">CORRECT</div>
                                <div class="stat-value" id="correct-count">0</div>
                            </div>
                            <div class="stat-card incorrect">
                                <div class="stat-label">INCORRECT</div>
                                <div class="stat-value" id="incorrect-count">0</div>
                            </div>
                            <div class="stat-card progress">
                                <div class="stat-label">PROGRESS</div>
                                <div class="stat-value" id="progress-display">0/0</div>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div id="progress-fill" class="progress-fill"></div>
                        </div>
                        <div class="accuracy-display" id="accuracy-display">Accuracy (so far): 0%</div>
                    </div>

                    <!-- Active Filters -->
                    <div class="sidebar-section">
                        <h3>Active Filters</h3>
                        <div class="filter-tags" id="filter-tags">
                            <span class="filter-tag">All Subjects</span>
                            <span class="filter-tag">All Levels</span>
                            <span class="filter-tag">10s per question</span>
                        </div>
                    </div>

                    <!-- Shortcuts -->
                    <div class="sidebar-section">
                        <h3>Shortcuts</h3>
                        <div class="shortcuts-list">
                            <div class="shortcut-item">
                                <span class="shortcut-key">Enter</span>
                                <span class="shortcut-action">Submit</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-key">Space</span>
                                <span class="shortcut-action">Pause / Resume</span>
                            </div>
                            <div class="shortcut-item">
                                <span class="shortcut-key">Tab</span>
                                <span class="shortcut-action">Navigate controls</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Summary Screen -->
        <section id="summary-screen" class="screen">
            <div class="summary-container">
                <div class="summary-header">
                    <button type="button" id="back-to-practice" class="btn-secondary">‚Üê Back to Practice</button>
                    <h2>Session Summary</h2>
                    <button type="button" id="export-csv" class="btn-primary">
                        <span class="btn-icon">üì•</span>
                        Export CSV
                    </button>
                </div>

                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card overall">
                        <h3>OVERALL</h3>
                        <div class="score-display">
                            <span id="overall-score" class="score">0/0</span>
                            <span id="overall-percentage" class="percentage">(0%)</span>
                        </div>
                        <div class="overall-progress">
                            <div class="progress-bar">
                                <div id="overall-progress-fill" class="progress-fill"></div>
                            </div>
                        </div>
                    </div>

                    <div class="summary-card by-subject">
                        <h3>BY SUBJECT</h3>
                        <div id="subject-accuracy" class="subject-accuracy"></div>
                    </div>

                    <div class="summary-card filters">
                        <h3>FILTERS</h3>
                        <div class="filter-tags" id="summary-filter-tags">
                            <span class="filter-tag">All Subjects</span>
                            <span class="filter-tag">All Levels</span>
                            <span class="filter-tag">10s per question</span>
                        </div>
                    </div>
                </div>

                <!-- Missed Questions -->
                <div class="missed-questions">
                    <h3>Missed Questions</h3>
                    <div id="missed-table" class="missed-table"></div>
                </div>

                <!-- Actions -->
                <div class="summary-actions">
                    <button type="button" id="new-session" class="btn-secondary">New Session</button>
                </div>
            </div>
        </section>
    </main>

    <!-- ARIA Live Regions -->
    <div aria-live="polite" class="sr-only" id="status-announcement"></div>
    <div aria-live="assertive" class="sr-only" id="error-announcement"></div>

    <footer>
        <p>NCAL Study App - Offline Practice Tool</p>
    </footer>

    <script type="module" src="app.js"></script>
</body>
</html>
